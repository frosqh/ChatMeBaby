<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" type="text/css" href="../front/css/chat.css">

  <link rel="stylesheet" type="text/css" href="../front/css/index.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Pacifico" rel="stylesheet">
  <link rel="icon" href="../Logo/LogoTrans.png" type="image/png" sizes="16x16">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
</head>
<body id="body">

  <div class="header" style="background: linear-gradient(0.25turn,#0951c4, #95b4e5,#0951c4);">
    <a href="home.html"><img id='LogoTransparent' src="../Logo/LogoWithNameTrans.png" alt="LogoTransparent" /></a>
    <div class="connectedUser">
      <table id="userText" border="0">
        <td>User</td>
        <td id="settingico"><a><img src="../Logo/Icones/settings.png"/></a></td>
        <td class="settingsPage" id="signoutico"><a><img src="../Logo/Icones/signOut.png"/></a></td>
      </table>
    </div>
  </div>

  <div class="topnav">
    <a href="home.html">Home</a>
    <a class="indexPage" href="channel.html">MyChatRooms</a>
    <a href="#">MyChatFriends</a>
    <a href="#">Surprise Me!</a>
    <div class="searchbarbutton">
      <form id="searchForm" method="post">
        <input class="searchbar" type="text" placeholder="Search ..." style="border:none; outline:none; border-bottom:1px solid #757575;"/>
        <input class="searchbutton" type="submit" value=""></input>
      </form>
    </div>
  </div>

<div class="row">
  <div class="client_channel_list_container">
    <div class="sidebar">
      <a href="home.html"><img src="../Logo/LogoWithNameTrans.png" style="height:70px; width:auto; padding-left: 25px; padding-top:5px;"/></a>
      <div class="workingLab_sidebar">
        <div class="menu_user">
          <div class="disponible"></div>
          <p class="username">UserName</p>
        </div>
      </div>
      <div class="channel_sidebar">
        <p class="channelTitle">Channels</p>
        <p class="channel">General</p>
        <p class="channel">Random</p>
      </div>
      <div class="privateMessage_sidebar">
        <p class="PrivateMessageTitle">Private Message</p>
        <div class="user">
          <div class="disponible"></div>
          <p class="username">Tanguy</p>
        </div>
        <div class="user">
          <div class="absent"></div>
          <p class="username">Jeremy</p>
        </div>
        <div class="user">
          <div class="absent"></div>
          <p class="username">Baptiste</p>
        </div>
        <div class="user">
          <div class="absent"></div>
          <p class="username">Gautier</p>
        </div>
      </div>
      <div class="addPeople_sidebar">
        <p class="addPeople">Add people</p>
      </div>
      <div class="baby_sidebar">
        <p class="babyTitle">Chat new babies</p>
        <p class="baby">New Baby</p>
        <p class="baby">Random baby</p>
      </div>
    </div>
  </div>


  <div class="rightcolumn">
    <div class="topnavchat">
      <div>
        <p><b>#channelName</b></p>
      </div>
    </div>
    <div class = content>
      <section id="zone_chat">

      </section>
    </div>
    <form class="form" action="" class="formulaire_chat">
      <div>
        <input id="m" autocomplete="off" type="text" class="input_text"/>
        <input type="submit" id="envoi_message">
        </input>
      </div>
    </form>

  </div>

</div>

<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>

    // Connexion � socket.io
    var socket = io.connect();

    // On demande le pseudo, on l'envoie au serveur et on l'affiche dans le titre
    var pseudo = prompt('Quel est votre pseudo ?');
    socket.emit('nouveau_client', pseudo);
    document.title = pseudo + ' - ' + document.title;

    // Quand on re�oit un message, on l'ins�re dans la page
    socket.on('message', function(data) {
        insereMessage(data.pseudo, data.message)
    })

    // Quand un nouveau client se connecte, on affiche l'information
    socket.on('nouveau_client', function(pseudo) {
        $('#zone_chat').append('<p><em>' + pseudo + ' a rejoint le Chat !</em></p>');
    })

    // Lorsqu'on envoie le formulaire, on transmet le message et on l'affiche sur la page
    $('#formulaire_chat').submit(function () {
        var message = $('#m').val();
        console.log(message);
        socket.emit('message', message); // Transmet le message aux autres
        insereMessage(pseudo, message); // Affiche le message aussi sur notre page
        $('#m').val('').focus(); // Vide la zone de Chat et remet le focus dessus
        return false; // Permet de bloquer l'envoi "classique" du formulaire
    });

    // Ajoute un message dans la page
    function insereMessage(pseudo, message) {
        $('#zone_chat').append('<p><strong>' + 'Tanguy' + '</strong> ' + message + '</p>');
    }
</script>

</body>
</html>
